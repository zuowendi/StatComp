"0","set.seed(3000)"
"0",""
"0","lap_f = function(x) exp(-abs(x))"
"0",""
"0","rw.Metropolis = function(sigma, x0, N){"
"0"," x = numeric(N)"
"0"," x[1] = x0"
"0"," u = runif(N)"
"0"," k = 0"
"0"," for (i in 2:N) {"
"0","  y = rnorm(1, x[i-1], sigma)"
"0","  if (u[i] <= (lap_f(y) / lap_f(x[i-1]))) x[i] = y "
"0","  else {"
"0","  x[i] = x[i-1]"
"0","  k = k+1"
"0","  }"
"0"," }"
"0"," return(list(x = x, k = k))"
"0","}"
"0",""
"0","N = 2000"
"0","sigma = c(.05, .5, 2, 16)"
"0","x0 = 25"
"0","rw1 = rw.Metropolis(sigma[1],x0,N)"
"0","rw2 = rw.Metropolis(sigma[2],x0,N)"
"0","rw3 = rw.Metropolis(sigma[3],x0,N)"
"0","rw4 = rw.Metropolis(sigma[4],x0,N)"
"0","#number of candidate points rejected"
"0","Rej = cbind(rw1$k, rw2$k, rw3$k, rw4$k)"
"0","Acc = round((N-Rej)/N,4)"
"0","rownames(Acc) = ""Accept rates"""
"0","colnames(Acc) = paste(""sigma"",sigma)"
"0","knitr::kable(Acc)"
